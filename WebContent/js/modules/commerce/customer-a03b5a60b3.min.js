!function(){$.MsgBox={Alert:function(t,e,n){o("alert",t,e),i(n),d()},Judge:function(t,e,n){o("judge",t,e),c(n),d()},Confirm:function(t,e,n){o("confirm",t,e),i(n),d()},Prompt:function(t,e,n){o("prompt",t,e),i(n),d()},Remind:function(t,e,n){o("remind",t,e),i(n),d()}};var o=function(t,e,n){var o="";o+='<div id="mb_box"></div><div id="mb_con"><span id="mb_tit">'+e+"</span>",o+='<a id="mb_ico"></a><div id="mb_msg">'+n+'</div><div id="mb_btnbox">',"alert"==t&&(o+='<input id="mb_btn_ok" type="button" value="确定" />'),"judge"==t&&(o+='<input id="mb_jug_ok" type="button" value="确定" />'),"confirm"==t&&(o+='<input id="mb_btn_ok" type="button" value="是" />',o+='<input id="mb_btn_no" type="button" value="否" />'),"prompt"==t&&(o+='<span style="display:inline-block;width:100%;height:27px;background:#00aeef"></span>'),"remind"==t&&(o+='<span style="display:inline-block;width:100%;height:27px;background:#fff;margin-top: -1px;"></span>'),o+="</div></div>",$("body").append(o),a()},a=function(){$("#mb_box").css({width:"100%",height:"100%",zIndex:"99999",position:"fixed",filter:"Alpha(opacity=60)",backgroundColor:"rgba(10%,20%,30%,0.6)",top:"0",left:"0",opacity:"0.6"}),$("#mb_con").css({zIndex:"999999",width:"355px",height:"189px",position:"fixed",backgroundColor:"White",borderRadius:"",border:"1px solid #fff"}),$("#mb_tit").css({display:"block",fontSize:"16px",color:"#444",padding:"2px 15px",backgroundColor:"#00aeef",borderRadius:"",borderBottom:"",fontWeight:"normal",fontFamily:"microsoft yahei"}),$("#mb_msg").css({height:"60px",lineHeight:"125px",fontSize:"13px",textAlign:"center",fontSize:"16px",fontFamily:"microsoft yahei"}),$("#mb_msg p").css({height:"30px",lineHeight:"30px",width:"350px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}),$("#mb_btnbox").css({margin:"75px 0 0",textAlign:"center",background:"#00aeef",paddingTop:"1px"}),$("#mb_btn_ok,#mb_jug_ok,#mb_btn_no").css({width:"60px",height:"28px",color:"#000",border:"1px solid #fff",borderRadius:"3px",background:"#00aeef",fontSize:"14px",fontFamily:"microsoft yahei"}),$("#mb_btn_ok,#mb_jug_ok").css({backgroundColor:"#00aeef"}),$("#mb_btn_no").css({backgroundColor:"#00aeef",marginLeft:"20px"}),$("#mb_ico").hover(function(){$(this).css({backgroundColor:"Red",color:"White"})},function(){$(this).css({backgroundColor:"#DDD",color:"black"})});var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight,n=$("#mb_con").width(),o=$("#mb_con").height();$("#mb_con").css({top:(e-o)/2+"px",left:(t-n)/2+"px"})},i=function(t){$("#mb_btn_ok").click(function(){$("#mb_box,#mb_con").remove(),"function"==typeof t&&t()})},c=function(t){$("#mb_jug_ok").click(function(){$("#mb_box,#mb_con").remove(),"function"==typeof t&&t()})},d=function(){$("#mb_btn_no,#mb_ico").click(function(){$("#mb_box,#mb_con").remove()})}}();var ProvinceandCity={"北京":["东城区","西城区","崇文区","宣武区","朝阳区","海淀区","丰台区","石景山区","房山区","通州区","顺义区","昌平区","大兴区","怀柔区","平谷区","门头沟区","密云县","延庆县"],"天津":["和平区","河东区","河西区","南开区","河北区","红桥区","东丽区","西青区","北辰区","津南区","武清区","宝坻区","滨海新区","静海县","宁河县","蓟县"],"上海":["黄浦区","卢湾区","徐汇区","长宁区","静安区","普陀区","闸北区","虹口区","杨浦区","闵行区","宝山区","嘉定区","浦东新区","金山区","松江区","青浦区","奉贤区","崇明县"],"重庆":["渝中区","大渡口区","江北区","南岸区","北碚区","渝北区","巴南区","长寿区","双桥区","沙坪坝区","万盛区","万州区","涪陵区","黔江区","永川区","合川区","江津区","九龙坡区","南川区","綦江县","潼南县","荣昌县","璧山县","大足县","铜梁县","梁平县","开县","忠县","城口县","垫江县","武隆县","丰都县","奉节县","云阳县","巫溪县","巫山县"],"河北":["石家庄","唐山","秦皇岛","邯郸","邢台","保定","张家口","承德","沧州","廊坊","衡水"],"山西":["太原","大同","阳泉","长治","晋城","朔州","晋中","运城","忻州","临汾","吕梁"],"辽宁":["沈阳","大连","鞍山","抚顺","本溪","丹东","锦州","营口","阜新","辽阳","盘锦","铁岭","朝阳","葫芦岛"],"吉林":["长春","吉林","四平","辽源","通化","白山","松原","白城","延边朝鲜族自治州"],"黑龙江":["哈尔滨","齐齐哈尔","鹤岗","双鸭山","鸡西","大庆","伊春","牡丹江","佳木斯","七台河","黑河","绥化","大兴安岭"],"江苏":["南京","苏州","无锡","常州","镇江","南通","泰州","扬州","盐城","连云港","徐州","淮安","宿迁"],"浙江":["杭州","宁波","温州","嘉兴","湖州","绍兴","金华","衢州","舟山","台州","丽水"],"安徽":["合肥","芜湖","蚌埠","淮南","马鞍山","淮北","铜陵","安庆","黄山","滁州","阜阳","宿州","巢湖","六安","亳州","池州","宣城"],"福建":["福州","厦门","莆田","三明","泉州","漳州","南平","龙岩","宁德"],"江西":["南昌","景德镇","萍乡","九江","新余","鹰潭","赣州","吉安","宜春","抚州","上饶"],"山东":["济南","青岛","淄博","枣庄","东营","烟台","潍坊","济宁","泰安","威海","日照","莱芜","临沂","德州","聊城","滨州","菏泽"],"河南":["郑州","开封","洛阳","平顶山","安阳","鹤壁","新乡","焦作","濮阳","许昌","漯河","三门峡","南阳","商丘","信阳","周口","驻马店"],"湖北":["武汉","黄石","十堰","荆州","宜昌","襄樊","鄂州","荆门","孝感","黄冈","咸宁","随州","恩施"],"湖南":["长沙","株洲","湘潭","衡阳","邵阳","岳阳","常德","张家界","益阳","郴州","永州","怀化","娄底","湘西"],"广东":["广州","深圳","珠海","汕头","韶关","佛山","江门","湛江","茂名","肇庆","惠州","梅州","汕尾","河源","阳江","清远","东莞","中山","潮州","揭阳","云浮"],"海南":["海口","三亚"],"四川":["成都","自贡","攀枝花","泸州","德阳","绵阳","广元","遂宁","内江","乐山","南充","眉山","宜宾","广安","达州","雅安","巴中","资阳","阿坝","甘孜","凉山"],"贵州":["贵阳","六盘水","遵义","安顺","铜仁","毕节","黔西南","黔东南","黔南"],"云南":["昆明","曲靖","玉溪","保山","昭通","丽江","普洱","临沧","德宏","怒江","迪庆","大理","楚雄","红河","文山","西双版纳"],"陕西":["西安","铜川","宝鸡","咸阳","渭南","延安","汉中","榆林","安康","商洛"],"甘肃":["兰州","嘉峪关","金昌","白银","天水","武威","酒泉","张掖","庆阳","平凉","定西","陇南","临夏","甘南"],"青海":["西宁","海东","海北","海南","黄南","果洛","玉树","海西"],"内蒙古":["呼和浩特","包头","乌海","赤峰","通辽","鄂尔多斯","呼伦贝尔","巴彦淖尔","乌兰察布","锡林郭勒盟","兴安盟","阿拉善盟"],"广西":["南宁","柳州","桂林","梧州","北海","防城港","钦州","贵港","玉林","百色","贺州","河池","来宾","崇左"],"西藏":["拉萨","那曲","昌都","林芝","山南","日喀则","阿里"],"宁夏":["银川","石嘴山","吴忠","固原","中卫"],"新疆":["乌鲁木齐","克拉玛依","吐鲁番","哈密","和田","阿克苏","喀什","克孜勒苏","巴音郭楞","昌吉","博尔塔拉","伊犁","塔城","阿勒泰"],"香港":["香港岛","九龙东","九龙西","新界东","新界西"],"澳门":["澳门半岛","离岛"],"台湾":["台北","高雄","基隆","新竹","台中","嘉义","台南"]},exportData=new Object;function pageStyle(t,e,n){n=n||"",1==e?$("#fistPage"+n+", #upPage"+n+", #nextPage"+n+", #lastPage"+n+", #Gotojump"+n).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"):1==t?($("#fistPage"+n+", #upPage"+n).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"),$("#lastPage"+n+", #nextPage"+n+", #Gotojump"+n).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")):t==e?($("#lastPage"+n+", #nextPage"+n).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"),$("#fistPage"+n+", #upPage"+n+", #Gotojump"+n).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")):$("#lastPage"+n+", #nextPage"+n+", #fistPage"+n+", #upPage"+n+", #Gotojump"+n).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")}function Check(t){"single"==t?($(".select2").hide(),$(".select-content").css("margin-left","33%")):($(".select2").show(),$(".select-content").css("margin-left","23%"))}function Search(){$("#search").val("search"),$("#top_text_from").attr("action","GetCustomerInfo2"),$("#top_text_from").submit()}function Cancel(){$("#search").val("cancel"),$('input[name="Contect1"]').val(""),$('input[name="Contect2"]').val(""),$("#top_text_from").attr("action","Customer"),$("#top_text_from").submit()}function AddContract(){$('.info_add input[type="text"').val(""),$(".cover-color").show(),$(".info_add").show()}exportData.CustomerName=null,exportData.EnglishName=null,exportData.Contact=null,exportData.ContactInfo=null,exportData.CustomerDepartment=null,exportData.Email=null,exportData.ContactAddress=null,"singleSelect"==$('input[name="selected"]:checked').val()?$(".select-content").css("margin-left","33%"):$(".select-content").css("margin-left","23%"),$("#searchContent1").keypress(function(t){$("#search").val("search"),"13"==(t.keyCode?t.keyCode:t.which)&&$("#top_text_from").submit()}),$("#searchContent2").keypress(function(t){$("#search").val("search"),"13"==(t.keyCode?t.keyCode:t.which)&&$("#top_text_from").submit()}),$(".infoAdd_close").click(function(){$(".cover-color").hide(),$(".info_add").hide()}),$(".info_add .search").mousedown(function(){$('.info_add select[name="module"]').show()}),$(".info_add .search").change(function(){$('.info_add select[name="module"]').hide()}),$(document).on("click",".info_add select[name='module'] option",function(){$('.info_add select[name="module"]').hide(),$(".info_add .search").val($('.info_add select[name="module"]').text())}),$("#add_submit").click(function(){var area=$('.info_add input[name="area"]').val().trim(),areaHook=0;for(var kk in ProvinceandCity)if(area==kk){areaHook=1;break}if(0==areaHook)return $.MsgBox_Unload.Alert("省份填写错误提示及示例","内蒙古自治区填内蒙古，香港特别行政区填香港"),!1;var id=$('.info_add input[name="id"]').val(),customer_name=$('.info_add input[name="customer_name"]').val(),EnglishName=$('.info_add input[name="EnglishName"]').val(),customer_classify="null",contact=$('.info_add input[name="contact"]').val(),contact_info1=$('.info_add input[name="contact_info1"]').val(),contact_info2=$('.info_add input[name="contact_info2"]').val(),contact_address=$('.info_add input[name="contact_address"]').val(),zip_code=$('.info_add input[name="zip_code"]').val(),fax_number=$('.info_add input[name="fax_number"]').val(),email=$('.info_add input[name="email"]').val(),shorthand_coding="null",Website=$('.info_add input[name="Website"]').val(),customer_department=$('.info_add input[name="customer_department"]').val(),Englishcustomer_department=$('.info_add input[name="Englishcustomer_department"]').val(),CustomerLevel=$(".info_add #CustomerLevel").val(),City=$('.info_add  input[name="City"]').val();$.ajax({type:"post",url:"CustomerOperate",data:{id:id,customer_name:customer_name,EnglishName:EnglishName,customer_classify:customer_classify,contact:contact,contact_info1:contact_info1,contact_info2:contact_info2,contact_address:contact_address,area:area,zip_code:zip_code,fax_number:fax_number,email:email,shorthand_coding:shorthand_coding,Website:Website,CustomerDepartment:customer_department,DepartmentEnglish:Englishcustomer_department,classify:"新增",CustomerLevel:CustomerLevel,City:City},dataType:"json",success:function(data){console.log(data),data=eval("("+data+")"),data.message?$.MsgBox.Alert("提示","添加成功！"):$.MsgBox.Alert("提示","添加失败！")},error:function(){$.MsgBox.Alert("提示","服务器繁忙，稍后重试！")}})}),$("#add_cancel").click(function(){$(".cover-color").hide(),$(".info_add").hide()}),$(".edit").click(function(){var t=$(this).parent(),e=$(".info_update");e.find('input[name="id"]').val($(this).attr("value")),e.find('input[name="customer_name"]').val(t.find(".CustomerName").html()),e.find('input[name="EnglishName"]').val(t.find(".EnglishName").html()),e.find('input[name="customer_classify"]').val(t.find(".CustomerClassify").html()),e.find('input[name="contact"]').val(t.find(".Contact").html()),e.find('input[name="contact_info1"]').val(t.find(".ContactInfo1").html()),e.find('input[name="contact_info2"]').val(t.find(".ContactInfo2").html()),e.find('input[name="contact_address"]').val(t.find(".ContactAddress").html()),e.find('input[name="area"]').val(t.find(".Area").html()),e.find('input[name="zip_code"]').val(t.find(".ZipCode").html()),e.find('input[name="fax_number"]').val(t.find(".FaxNumber").html()),e.find('input[name="email"]').val(t.find(".Email").html()),e.find('input[name="shorthand_coding"]').val(t.find(".ShorthandCoding").html()),e.find('input[name="Website"]').val(t.find(".Website").html()),e.find('input[name="customer_department"]').val(t.find(".CustomerDepartment").html()),e.find('input[name="Englishcustomer_department"]').val(t.find(".DepartmentEnglish").html()),e.find('input[name="City"]').val(t.find(".City").html()),e.find("#CustomerLevel").val(t.find("td.CustomerLevel").html()),$(".cover-color").show(),e.show();var n=$(this).attr("value");$('.info_update input[name="id"]').val(n)}),$("#update_submit").click(function(){var area=$('.info_update input[name="area"]').val().trim(),areaHook=0;for(var kk in ProvinceandCity)if(area==kk){areaHook=1;break}if(0==areaHook)return $.MsgBox_Unload.Alert("省份填写错误提示及示例","内蒙古自治区填内蒙古，香港特别行政区填香港"),!1;var id=$('.info_update input[name="id"]').val(),customer_name=$('.info_update input[name="customer_name"]').val(),EnglishName=$('.info_update input[name="EnglishName"]').val(),customer_classify="null",contact=$('.info_update input[name="contact"]').val(),contact_info1=$('.info_update input[name="contact_info1"]').val(),contact_info2=$('.info_update input[name="contact_info2"]').val(),contact_address=$('.info_update input[name="contact_address"]').val(),zip_code=$('.info_update input[name="zip_code"]').val(),fax_number=$('.info_update input[name="fax_number"]').val(),email=$('.info_update input[name="email"]').val(),shorthand_coding="null",Website=$('.info_update input[name="Website"]').val(),customer_department=$('.info_update input[name="customer_department"]').val(),Englishcustomer_department=$('.info_update input[name="Englishcustomer_department"]').val(),CustomerLevel=$(".info_update #CustomerLevel").val(),City=$('.info_update  input[name="City"]').val();$.ajax({type:"post",url:"CustomerOperate",data:{id:id,customer_name:customer_name,EnglishName:EnglishName,customer_classify:customer_classify,contact:contact,contact_info1:contact_info1,contact_info2:contact_info2,contact_address:contact_address,area:area,zip_code:zip_code,fax_number:fax_number,email:email,shorthand_coding:shorthand_coding,Website:Website,CustomerDepartment:customer_department,DepartmentEnglish:Englishcustomer_department,classify:"修改",CustomerLevel:CustomerLevel,City:City},dataType:"json",success:function(data){data=eval("("+data+")"),console.log(data.message),data.message?$.MsgBox.Alert("提示","修改成功！"):$.MsgBox_Unload.Alert("提示","修改失败！")},error:function(){$.MsgBox_Unload.Alert("提示","服务器繁忙，稍后重试！")}})}),$(".update_close, #update_cancel").click(function(){$(".cover-color, .info_update").hide()}),$(document).on("click","#mb_btn_ok",function(){window.location.reload()});var invoiceInfoObj={},invoiceSaveObj={};function FistPage(t){window.location.href=t+"1"}function UpPage(t){window.location.href=t}function NextPage(t){window.location.href=t}function PageJump(t){var e=document.getElementById("jumpNumber").value;null==e||0==e?e=$("#currentPage").html():e>parseInt($("#allPage").html())&&(e=$("#allPage").html()),window.location.href=t+e}function LastPage(t){var e=parseInt($("#allPage").html());window.location.href=t+e}$(document).on("click",".invoiceInfo_td>span",function(){$(".cover-color, .invoice_tshow").slideDown(200),$("#invoice_tableshow tbody tr td:nth-child(2)").each(function(){$(this).text("")});var t,e=$(this).parent(),n=e.siblings("td.edit").attr("value");t=e.siblings("td.Contact").text();var o=e.siblings("td.ContactAddress").text(),a=e.siblings("td.ContactInfo1").text(),i=e.siblings("td.ContactAddress").text(),c=e.siblings("td.ContactInfo1").text();t=globalDataHandle(t,""),o=globalDataHandle(o,""),a=globalDataHandle(a,""),i=globalDataHandle(i,""),c=globalDataHandle(c,""),(invoiceInfoObj={}).ID=n,invoiceInfoObj.Account="",invoiceInfoObj.DepositBank="",invoiceInfoObj.InvoiceRecepter=t,invoiceInfoObj.InvoiceTitle="",invoiceInfoObj.LinkAddress=o,invoiceInfoObj.LinkTel=a,invoiceInfoObj.LinkZipCode="",invoiceInfoObj.RegisterAddress=i,invoiceInfoObj.TaxPayerIdentityNO="",invoiceInfoObj.Telephone=c,console.log(invoiceInfoObj),$.ajax({type:"GET",url:"TaxInfo",data:{ID:n},dataType:"json",success:function(t){if(console.log(typeof t),1<t.length)for(var e in invoiceInfoObj)""==t[1][e]||"--"==t[1][e]||null==t[1][e]||null==t[1][e]?$("#invoice_tableshow tbody").find(".invo_"+e).text(invoiceInfoObj[e]):$("#invoice_tableshow tbody").find(".invo_"+e).text(t[1][e]);else if(1==t.length)for(var n in invoiceInfoObj)$("#invoice_tableshow tbody").find(".invo_"+n).text(invoiceInfoObj[n])},error:function(){$.MsgBox_Unload.Alert("提示","网络繁忙，获取开票信息失败")}})}),$(document).on("click",".invoice_tshow_tit_r, #invoice_tshow_close",function(){invoiceInfoObj={},invoiceSaveObj={},$(".invoice_tshow").fadeOut(200),$(".cover-color").fadeOut(200)}),$("#invoice_tshow_submit").on("click",function(){invoiceSaveObj.ID=invoiceInfoObj.ID;var t=$(".invo_InvoiceTitle").text().trim(),e=$(".invo_TaxPayerIdentityNO").text().trim(),n=$(".invo_RegisterAddress").text().trim(),o=$(".invo_Telephone").text().trim(),a=$(".invo_DepositBank").text().trim(),i=$(".invo_Account").text().trim(),c=$(".invo_InvoiceRecepter").text().trim(),d=$(".invo_LinkAddress").text().trim(),l=$(".invo_LinkTel").text().trim(),r=$(".invo_LinkZipCode").text().trim();invoiceSaveObj.InvoiceTitle=t,invoiceSaveObj.TaxPayerIdentityNO=e,invoiceSaveObj.RegisterAddress=n,invoiceSaveObj.Telephone=o,invoiceSaveObj.DepositBank=a,invoiceSaveObj.Account=i,invoiceSaveObj.InvoiceRecepter=c,invoiceSaveObj.LinkAddress=d,invoiceSaveObj.LinkTel=l,invoiceSaveObj.LinkEmail=r,$.ajax({type:"POST",url:"TaxInfo",data:invoiceSaveObj,dataType:"text",contentType:"application/x-www-form-urlencoded;charset=utf-8",success:function(t){$.MsgBox_Unload.Alert("提示",t)},error:function(){$.MsgBox_Unload.Alert("提示","网络繁忙!刷新重试")},complete:function(t,e){"success"==e&&$("#invoice_tshow_close").trigger("click")}})}),$(document).ready(function(){$("#invoice_tableshow tbody tr td:nth-child(2)").attr("contenteditable","true"),pageStyle(Number($("#currentPage").html()),Number($("#allPage").html()),""),"mix"==$("#hideQuery").attr("value")?$(".select2").show():$(".select2").hide()}),$(document).on("click","td.export_td>span",function(){var o=$(this).parent().parent();$(".export_cover, .export_div").slideDown(250),$(".export_div_body_in table td[class^='export_']").each(function(){var t,e=$(this).attr("class").replace("export_","");t=$(this).is(".export_ContactInfo")?globalDataHandle(o.find(".ContactInfo1").text(),"")+(""==globalDataHandle(o.find(".ContactInfo2").text(),"")?"":"/"+o.find(".ContactInfo1").text()):o.find("td."+e).text();var n=globalDataHandle(t,"");$(this).text(n),""==n?$(this).parent().addClass("warning"):$(this).parent().removeClass("warning"),exportData[e]=n})}),$(".export_div_tit>span, #export_div_cancel").click(function(){for(var t in $(".export_cover, .export_div").slideUp(250),exportData)exportData[t]=null}),$("#export_div_submit").click(function(){$.ajax({type:"POST",url:"Customer",data:exportData}).then(function(t){window.open(t)},function(){$.MsgBox_Unload.Alert("提示","网络繁忙！")})});