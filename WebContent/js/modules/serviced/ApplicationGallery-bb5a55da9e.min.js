var search_all_param=new Object;search_all_param.scheme=["选择字段","应用类型","客户名称","方案名称","机台型号","制定时间"],search_all_param.standard=["选择字段","产品名称","产品类型","适用机台","版本号","设计时间","使用情况"],search_all_param.customization=["选择字段","产品名称","产品类型","适用机台","版本号","设计时间","使用情况"];var ApplicationGalleryState=new Object;function getDataByPage(i,l,n,s,o,r,d){$.ajax({type:"GET",url:"ApplicationGallery",data:{LoadType:"data",Category:i,QueryType:l,Column1:n,Content1:s,Column2:o,Content2:r,CurrentPage:d},dataType:"json"}).then(function(t){var a=t.data,e=t.pageCount;renderPageData(i,a,d,e),ApplicationGalleryState.hasSearch=void 0!==l,ApplicationGalleryState.searchQueryType=l,ApplicationGalleryState.searchColumn1=n,ApplicationGalleryState.searchContent1=s,ApplicationGalleryState.searchColumn2=o,ApplicationGalleryState.searchContent2=r},function(){$.MsgBox_Unload.Alert("提示","服务器繁忙！页面数据获取失败")}).always(function(){})}function renderPageData(t,a,p,e){var i,c="";1==a.length?c+='<tr><td colspan="'+("scheme"==t?9:10)+'">无数据......</td></tr>':1<a.length&&("scheme"==t?a.map(function(t,a,e){if(0<a){var i=parseInt(10*(p-1)+a),l="",n=t.CADdrawings.split("::");if(0==(n=$.grep(n,function(t,a){return""!=t})).length)l+="未上传";else if(n.length<3)n.map(function(t,a,e){a!=n.length?l+="<span class='td_download_file' title='"+t+"'>"+t+"</span><br>":l+="<span class='td_download_file' title='"+t+"'>"+t+"</span>"});else{var s='<div class="container-fluid" style="padding-left: 1px;padding-right: 1px;padding-bottom:5px;">';s+="<ol>",n.map(function(t,a,e){s+='<li title="'+t+'">'+t+"</li>"}),s+="</ol>",s+="</div>",l+="<span class='td_download_file' title='"+n[0]+"'>"+n[0]+"</span><br>",l+="<span class='td_download_file' title='"+n[1]+"'>"+n[1]+"</span><br>",l+="<a tabindex='0' class='btn btn-info' role='button' data-toggle='popover' data-trigger='focus' data-placement='left' title='第"+i+"条记录--CAD图纸' data-content='"+s+"'>显示更多...</a>"}var o="",r=t.PDFdrawings.split("::");if(0==(r=$.grep(r,function(t,a){return""!=t})).length)o+="未上传";else if(r.length<3)r.map(function(t,a,e){a!=r.length?o+="<span class='td_download_file' title='"+t+"'>"+t+"</span><br>":o+="<span class='td_download_file' title='"+t+"'>"+t+"</span>"});else{var d='<div class="container-fluid" style="padding-left: 1px;padding-right: 1px;padding-bottom:5px;">';d+="<ol>",r.map(function(t,a,e){d+='<li title="'+t+'">'+t+"</li>"}),d+="</ol>",d+="</div>",o+="<span class='td_download_file' title='"+r[0]+"'>"+r[0]+"</span><br>",o+="<span class='td_download_file' title='"+r[1]+"'>"+r[1]+"</span><br>",o+="<a tabindex='0' class='btn btn-info' role='button' data-toggle='popover' data-trigger='focus' data-placement='left' title='第"+i+"条记录--PDF图纸' data-content='"+d+"'>显示更多...</a>"}c+='<tr><td class="update_td" data-iid="'+t.ID+'">'+parseInt(10*(p-1)+a)+'</td><td class="hastd_ApplicationType" title="'+t.ApplicationType+'">'+t.ApplicationType+'</td><td class="hastd_CustomerName" title="'+t.CustomerName+'">'+t.CustomerName+'</td><td class="hastd_SchemeName" title="'+t.SchemeName+'">'+t.SchemeName+'</td><td class="hastd_MachineModel" title="'+t.MachineModel+'">'+t.MachineModel+'</td><td class="hastd_MakeTime" title="'+t.MakeTime+'">'+t.MakeTime+'</td><td class="hastd_CADdrawings" data-ivalue="'+t.CADdrawings+'">'+l+'</td><td class="hastd_PDFdrawings" data-ivalue="'+t.PDFdrawings+'">'+o+'</td><td class="hastd_Remark" title="'+t.Remark+'">'+t.Remark+"</td></tr>"}}):a.map(function(t,a,e){if(0<a){var i=parseInt(10*(p-1)+a),l="",n=t.CADdrawings.split("::");if(0==(n=$.grep(n,function(t,a){return""!=t})).length)l+="未上传";else if(n.length<3)n.map(function(t,a,e){a!=n.length?l+="<span class='td_download_file' title='"+t+"'>"+t+"</span><br>":l+="<span class='td_download_file' title='"+t+"'>"+t+"</span>"});else{var s='<div class="container-fluid" style="padding-left: 1px;padding-right: 1px;padding-bottom:5px;">';s+="<ol>",n.map(function(t,a,e){s+='<li title="'+t+'">'+t+"</li>"}),s+="</ol>",s+="</div>",l+="<span class='td_download_file' title='"+n[0]+"'>"+n[0]+"</span><br>",l+="<span class='td_download_file' title='"+n[1]+"'>"+n[1]+"</span><br>",l+="<a tabindex='0' class='btn btn-info' role='button' data-toggle='popover' data-trigger='focus' data-placement='left' title='第"+i+"条记录--CAD图纸' data-content='"+s+"'>显示更多...</a>"}var o="",r=t.PDFdrawings.split("::");if(0==(r=$.grep(r,function(t,a){return""!=t})).length)o+="未上传";else if(r.length<3)r.map(function(t,a,e){a!=r.length?o+="<span class='td_download_file' title='"+t+"'>"+t+"</span><br>":o+="<span class='td_download_file' title='"+t+"'>"+t+"</span>"});else{var d='<div class="container-fluid" style="padding-left: 1px;padding-right: 1px;padding-bottom:5px;">';d+="<ol>",r.map(function(t,a,e){d+='<li title="'+t+'">'+t+"</li>"}),d+="</ol>",d+="</div>",o+="<span class='td_download_file' title='"+r[0]+"'>"+r[0]+"</span><br>",o+="<span class='td_download_file' title='"+r[1]+"'>"+r[1]+"</span><br>",o+="<a tabindex='0' class='btn btn-info' role='button' data-toggle='popover' data-trigger='focus' data-placement='left' title='第"+i+"条记录--PDF图纸' data-content='"+d+"'>显示更多...</a>"}c+='<tr><td class="update_td" data-iid="'+t.ID+'">'+parseInt(10*(p-1)+a)+'</td><td class="hastd_ProductName" title="'+t.ProductName+'">'+t.ProductName+'</td><td class="hastd_ProductType" title="'+t.ProductType+'">'+t.ProductType+'</td><td class="hastd_Machine" title="'+t.Machine+'">'+t.Machine+'</td><td class="hastd_VersionNO" title="'+t.VersionNO+'">'+t.VersionNO+'</td><td class="hastd_DesignTime" title="'+t.DesignTime+'">'+t.DesignTime+'</td><td class="hastd_UseCondition" title="'+t.UseCondition+'">'+t.UseCondition+'</td><td class="hastd_CADdrawings" data-ivalue="'+t.CADdrawings+'">'+l+'</td><td class="hastd_PDFdrawings" data-ivalue="'+t.PDFdrawings+'">'+o+'</td><td class="hastd_Remark" title="'+t.Remark+'">'+t.Remark+"</td></tr>"}}));$("#"+t+"_a").children("table").find("tbody").empty().append(c),"scheme"==t?i="":"standard"==t?i="2":"customization"==t&&(i="3"),$(".g_body #currentPage"+i).text(p),$(".g_body #allPage"+i).text(e),pageStyle(p,e,i),$(".hastd_CADdrawings>a, .hastd_PDFdrawings>a").popover({title:"请预览",html:!0})}function pageStyle(t,a,e){e=e||"",1==a?$("#fistPage"+e+", #upPage"+e+", #nextPage"+e+", #lastPage"+e+", #Gotojump"+e).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"):1==t?($("#fistPage"+e+", #upPage"+e).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"),$("#lastPage"+e+", #nextPage"+e+", #Gotojump"+e).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")):t==a?($("#lastPage"+e+", #nextPage"+e).prop("disabled","disabled").removeClass("btn-primary").addClass("btn-default"),$("#fistPage"+e+", #upPage"+e+", #Gotojump"+e).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")):$("#lastPage"+e+", #nextPage"+e+", #fistPage"+e+", #upPage"+e+", #Gotojump"+e).prop("disabled",!1).removeClass("btn-default").addClass("btn-primary")}function getDataByGoPage(t){var a,e,i,l;ApplicationGalleryState.hasSearch?(a=ApplicationGalleryState.searchColumn1,e=ApplicationGalleryState.searchContent1,i=ApplicationGalleryState.searchColumn2,l=ApplicationGalleryState.searchContent2):l=i=e=a=void 0,getDataByPage($(".tab_wrapper>ul>li.active").children("a").data("idiagram"),ApplicationGalleryState.searchQueryType,a,e,i,l,t)}function searchParamInsert(){var t=$(".tab_wrapper>ul>li.active").children("a").data("idiagram"),a=search_all_param[t],i="";a.map(function(t,a,e){i+='<li title="'+t+'">'+t+"</li>"}),$(".search_in ul.dropdown-menu").empty().append(i)}function searchInit(){$(".tab_wrapper>ul>li:not(:eq(0))").removeClass("active"),$(".tab_wrapper>ul>li:eq(0)").addClass("active"),ApplicationGalleryState.hasSearch=!1,ApplicationGalleryState.searchQueryType=void 0,ApplicationGalleryState.searchColumn1=void 0,ApplicationGalleryState.searchContent1=void 0,ApplicationGalleryState.searchColumn2=void 0,ApplicationGalleryState.searchContent2=void 0,searchParamInsert(),$("input[name='querytype'][value='singleSelect']").prop("checked","checked"),$("input[name='querytype'][value='singleSelect']").parent().addClass("active").css("color","#333"),$("input[name='querytype'][value='mixSelect']").prop("checked",!1),$("input[name='querytype'][value='mixSelect']").parent().removeClass("active").css("color","#fff"),$(".mixSelect_search").fadeOut(50,function(){$(".singleSelect_search input[type='date'], .singleSelect_search select").fadeOut(50)}),$(".m_button div.input-group-btn>button:eq(0)").attr("title","选择字段").text("选择字段"),$(".singleSelect_search input[type='text'], .singleSelect_search input[type='date'], .singleSelect_search select, .mixSelect_search input[type='text'], .mixSelect_search input[type='date'], .mixSelect_search select").val("")}function uploadFiles(e,n,l){var t,s,i=new FormData;i.enctype="multipart/form-data",i.append("Folder","ApplicationGallery"),"CADdrawings"==l?(t=ApplicationGalleryState.uploadFileListCAD,s="CAD"):"PDFdrawings"==l&&(t=ApplicationGalleryState.uploadFileListPDF,s="PDF"),$.each(t,function(t,a){i.append("file",a)}),$.ajax({type:"POST",async:!0,accept:"application/json; charset=utf-8",data:i,url:"BatchUpload",processData:!1,contentType:!1,cache:!1,dataType:"json",xhr:function(){return myXhr=$.ajaxSettings.xhr(),myXhr.upload&&myXhr.upload.addEventListener("progress",function(t){var a=t.loaded,e=t.total,i=Math.floor(1e3*a/e)/10+"%";console.log("已经上传了："+i);var l=(100*globalToPoint(i)).toFixed(0);n.find("div.progress-bar").attr("aria-valuenow",l).css("width",i).text(i)},!1),myXhr},success:function(t){if(0<t.length){var i="";if(t.map(function(t,a,e){-1<t.Message.indexOf("成功")?(i+='<li class="list-group-item list-group-item-success" title="'+t.FileName+'" data-iitype="'+s+'"><span class="badge">成功</span>'+t.FileName+"</li>",0):-1<t.Message.indexOf("失败")?i+='<li class="list-group-item list-group-item-danger" title="'+t.FileName+'"><span class="badge">失败</span>'+t.FileName+"</li>":i+='<li class="list-group-item list-group-item-warning" title="'+t.FileName+'"><span class="badge">文件已存在</span>'+t.FileName+"</li>"}),n.find("li>span:contains('删除')").parent().remove(),n.find("ul").append(i),"CADdrawings"==l)for(var a in ApplicationGalleryState.uploadFileNoCAD=0,ApplicationGalleryState.uploadFileListCAD)delete ApplicationGalleryState.uploadFileListCAD[a];else if("PDFdrawings"==l)for(var e in ApplicationGalleryState.uploadFileNoPDF=0,ApplicationGalleryState.uploadFileListPDF)delete ApplicationGalleryState.uploadFileListPDF[e];n.prev().children("input[type='file']").val("")}else 0==t.length&&$.MsgBox_Unload.Alert("上传提示","文件读取至服务器失败！")},error:function(){n.find("div.progress-bar").prop("aria-valuenow","0").css("width","0%").text("0%"),$.MsgBox_Unload.Alert("上传提示","网络繁忙！上传失败！")},beforeSend:function(t){e.css("cursor","not-allowed").prop("disabled","disabled")},complete:function(t,a){e.css("cursor","pointer").prop("disabled",!1)}})}ApplicationGalleryState.uploadFileNoCAD=0,ApplicationGalleryState.uploadFileListCAD={},ApplicationGalleryState.uploadFileNoPDF=0,ApplicationGalleryState.uploadFileListPDF={},ApplicationGalleryState.hasSearch=!1,ApplicationGalleryState.searchQueryType=void 0,ApplicationGalleryState.searchColumn1=void 0,ApplicationGalleryState.searchContent1=void 0,ApplicationGalleryState.searchColumn2=void 0,ApplicationGalleryState.searchContent2=void 0,ApplicationGalleryState.hasLoadAddUpdateSection=!1,ApplicationGalleryState.hasLoadAddUpdatePageData=null,ApplicationGalleryState.curUpdateID=null,searchInit(),getDataByPage("scheme",void 0,void 0,void 0,void 0,void 0,1),$(".tab_wrapper>ul>li>a").click(function(t){t.preventDefault(),$(this).tab("show")}),$(".tab_wrapper>ul>li>a").on("shown.bs.tab",function(t){console.log(t.target),console.log(t.relatedTarget),console.log($(t.target)),ApplicationGalleryState.hasSearch=!1,ApplicationGalleryState.searchQueryType=void 0,ApplicationGalleryState.searchColumn1=void 0,ApplicationGalleryState.searchContent1=void 0,ApplicationGalleryState.searchColumn2=void 0,ApplicationGalleryState.searchContent2=void 0,searchParamInsert(),getDataByPage($(t.target).data("idiagram"),void 0,void 0,void 0,void 0,void 0,1)}),$(".m_button>.row>div:nth-child(1)>span").click(function(){var e=$(".tab_wrapper>ul>li.active").children("a").data("idiagram"),i=$("div.add_wrapper_"+e);ApplicationGalleryState.hasLoadAddUpdateSection?($(".bg_cover").slideDown(250),i.slideDown(250),$(ApplicationGalleryState.hasLoadAddUpdatePageData).each(function(t,a){if($(a).is("#add_section_"+e))return i.empty().append($(a)),!1}),i.find(".add_section_all_body_in select, .add_section_all_body_in input").val("")):i.load("html/modules/serviced/ApplicationGallery.html #add_section_"+e,function(t,a,e){"success"==a?(ApplicationGalleryState.hasLoadAddUpdateSection=!0,ApplicationGalleryState.hasLoadAddUpdatePageData=t,console.log(typeof ApplicationGalleryState.hasLoadAddUpdatePageData),$(".bg_cover").slideDown(250),i.slideDown(250),i.find(".add_section_all_body_in select, .add_section_all_body_in input").val("")):$.MsgBox_Unload.Alert("提示","网络繁忙！读取添加模板失败！")})}),$(document).on("click","[class$='_section_all_foot_in']>input[value='取消'], [class$='_section_all_tit_r']",function(t){t.stopPropagation();var a=$(this).parents(".ApplicationGallery_post"),e=a.parent();$(".bg_cover").slideUp(250),e.slideUp(250);var i=a.data("itype"),l=a.data("icategory");for(var n in $("div."+i+"_fileList_info").is(":visible")&&$("div."+i+"_fileList_info").slideUp(150,function(){$("div."+i+"_fileList_info>div>div.progress-bar").attr("aria-valuenow","0").css("width","0%").text("0%")}),$("#"+l+"_"+i+"_CADdrawings_list").empty(),$("#"+l+"_"+i+"_PDFdrawings_list").empty(),ApplicationGalleryState.uploadFileNoCAD=0,ApplicationGalleryState.uploadFileListCAD)delete ApplicationGalleryState.uploadFileListCAD[n];for(var s in ApplicationGalleryState.uploadFileNoPDF=0,ApplicationGalleryState.uploadFileListPDF)delete ApplicationGalleryState.uploadFileListPDF[s];a.find("input[type='file']").val(""),ApplicationGalleryState.curUpdateID=void 0}),$(document).on("click",".trigger_click",function(t){t.preventDefault(),$(this).next().trigger("click")}),$(document).on("change",".ApplicationGallery_post input[type='file']",function(){var t=$(this).parents(".ApplicationGallery_post"),a=t.data("itype"),e=(t.data("icategory"),$(this).parent().next()),i=$(this).data("ifiletype");e.find("div."+a+"_fileList_info").is(":visible")||e.find("div."+a+"_fileList_info").slideDown(150);var l=$(this)[0].files,n="";$.each(l,function(t,a){"CADdrawings"==i?(ApplicationGalleryState.uploadFileNoCAD++,n+='<li class="list-group-item" title="'+a.name+'" value="'+ApplicationGalleryState.uploadFileNoCAD+'" data-iitype="CAD"><span class="badge">删除</span>'+a.name+"</li>",ApplicationGalleryState.uploadFileListCAD[ApplicationGalleryState.uploadFileNoCAD]=a):"PDFdrawings"==i&&(ApplicationGalleryState.uploadFileNoPDF++,n+='<li class="list-group-item" title="'+a.name+'" value="'+ApplicationGalleryState.uploadFileNoPDF+'" data-iitype="PDF"><span class="badge">删除</span>'+a.name+"</li>",ApplicationGalleryState.uploadFileListPDF[ApplicationGalleryState.uploadFileNoPDF]=a)}),e.find("ul").append(n),e.children("div").find("div.progress-bar").prop("aria-valuenow","0").css("width","0%").text("0%")}),$(document).on("click","ul>li>span:contains('删除')",function(){var t=$(this).parent().data("iitype"),a=$(this).parent().attr("value");"CAD"==t?delete ApplicationGalleryState.uploadFileListCAD[a]:"PDF"==t&&delete ApplicationGalleryState.uploadFileListPDF[a],$(this).parent().remove()}),$(document).on("click","div[class$='_section_all_foot_in']>[id^='submit']",function(){$(this);var t,a,e=$(this).parents(".ApplicationGallery_post"),i=e.data("icategory"),l=e.data("itype");if("add"==l?(t="0",a="添加"):(t=ApplicationGalleryState.curUpdateID,a="修改"),"scheme"==i){var n=e.find("#"+l+"_scheme_ApplicationType").val().trim(),s=e.find("#"+l+"_scheme_CustomerName").val().trim(),o=e.find("#"+l+"_scheme_SchemeName").val().trim(),r=e.find("#"+l+"_scheme_MachineModel").val().trim(),d=e.find("#"+l+"_scheme_MakeTime").val().trim(),p=e.find("#"+l+"_scheme_Remark").val().trim();if(""===n)return $.MsgBox_Unload.Alert("提示","请填写应用类型！"),!1;var c=[];e.find("#scheme_"+l+"_CADdrawings_list").find("li.list-group-item-success, li.list-group-item-info").each(function(){c.push($(this).attr("title"))});var u=globalArrStrUnique(c),g=0==u.length?"":u.join("::")+"::",f=[];e.find("#scheme_"+l+"_PDFdrawings_list").find("li.list-group-item-success, li.list-group-item-info").each(function(){f.push($(this).attr("title"))});var h=globalArrStrUnique(f),_=0==h.length?"":h.join("::")+"::";$.ajax({type:"POST",url:"ApplicationGallery",data:{Category:i,Type:l,ID:t,ApplicationType:n,CustomerName:s,SchemeName:o,MachineModel:r,MakeTime:d,CADdrawings:g,PDFdrawings:_,Remark:p},dataType:"json"}).then(function(t){1==t?(e.find("[class$='_section_all_tit_r']").trigger("click"),$.MsgBox_Unload.Alert("提示",a+"成功"),getDataByPage(i,void 0,void 0,void 0,void 0,void 0,1)):0==t?$.MsgBox_Unload.Alert("提示",a+"失败"):$.MsgBox_Unload.Alert("提示",t)},function(){$.MsgBox_Unload.Alert("提示","网络繁忙！")}).always(function(){})}else{var m=e.find("#"+l+"_"+i+"_ProductName").val().trim(),v=e.find("#"+l+"_"+i+"_ProductType").val().trim(),y=e.find("#"+l+"_"+i+"_Machine").val().trim(),A=e.find("#"+l+"_"+i+"_VersionNO").val().trim(),b=e.find("#"+l+"_"+i+"_DesignTime").val().trim(),S=e.find("#"+l+"_"+i+"_UseCondition").val(),D=e.find("#"+l+"_"+i+"_Remark").val().trim();if(""===m)return $.MsgBox_Unload.Alert("提示","请填写产品名称！"),!1;if(!S)return $.MsgBox_Unload.Alert("提示","请选择使用情况！"),!1;var P=[];e.find("#"+i+"_"+l+"_CADdrawings_list").find("li.list-group-item-success, li.list-group-item-info").each(function(){P.push($(this).attr("title"))});var G=globalArrStrUnique(P),x=0==G.length?"":G.join("::")+"::",w=[];e.find("#"+i+"_"+l+"_PDFdrawings_list").find("li.list-group-item-success, li.list-group-item-info").each(function(){w.push($(this).attr("title"))});var C=globalArrStrUnique(w),F=0==C.length?"":C.join("::")+"::";$.ajax({type:"POST",url:"ApplicationGallery",data:{Category:i,Type:l,ID:t,ProductName:m,ProductType:v,Machine:y,VersionNO:A,DesignTime:b,Usage:S,CADdrawings:x,PDFdrawings:F,Remark:D},dataType:"json"}).then(function(t){1==t?(e.find("[class$='_section_all_tit_r']").trigger("click"),$.MsgBox_Unload.Alert("提示",a+"成功"),getDataByPage(i,void 0,void 0,void 0,void 0,void 0,1)):0==t?$.MsgBox_Unload.Alert("提示",a+"失败"):$.MsgBox_Unload.Alert("提示",t)},function(){$.MsgBox_Unload.Alert("提示","网络繁忙！")}).always(function(){})}}),$(document).on("click",".ApplicationGallery_post input[type='file']+label>button",function(){var t=$(this),a=$(this).parent().parent().next(),e=$(this).parent().prev().data("ifiletype");if("CADdrawings"==e){if(0==Object.keys(ApplicationGalleryState.uploadFileListCAD).length)return $.MsgBox_Unload.Alert("添加提示","请选择文件！"),!1}else if("PDFdrawings"==e&&0==Object.keys(ApplicationGalleryState.uploadFileListPDF).length)return $.MsgBox_Unload.Alert("添加提示","请选择文件！"),!1;uploadFiles(t,a,e)}),$(document).on("click",".update_td",function(){var o=$(".tab_wrapper>ul>li.active").children("a").data("idiagram"),r=$("div.update_wrapper_"+o),d=$(this).data("iid").toString(),p=$(this).parent();if(ApplicationGalleryState.hasLoadAddUpdateSection){$(".bg_cover").slideDown(250),r.slideDown(250),$(ApplicationGalleryState.hasLoadAddUpdatePageData).each(function(t,a){if($(a).is("#update_section_"+o))return r.empty().append($(a)),!1}),ApplicationGalleryState.curUpdateID=d,r.find("fieldset .form-control").each(function(){var t="hastd_"+$(this).attr("id").split("_")[2],a=p.children("."+t).attr("title"),e=globalDataHandle(a,"");$(this).val(e)});var t=p.find(".hastd_CADdrawings").data("ivalue").toString().split("::");t=$.grep(t,function(t,a){return""!=t});var i="";t.map(function(t,a,e){i+='<li class="list-group-item list-group-item-info" title="'+t+'"><span class="badge">已上传</span>'+t+"</li>"}),$("#"+o+"_update_CADdrawings_list").empty().append(i);var a=p.find(".hastd_PDFdrawings").data("ivalue").toString().split("::");a=$.grep(a,function(t,a){return""!=t});var l="";a.map(function(t,a,e){l+='<li class="list-group-item list-group-item-info" title="'+t+'"><span class="badge">已上传</span>'+t+"</li>"}),$("#"+o+"_update_PDFdrawings_list").empty().append(l)}else r.load("html/modules/serviced/ApplicationGallery.html #update_section_"+o,function(t,a,e){if("success"==a){ApplicationGalleryState.hasLoadAddUpdateSection=!0,ApplicationGalleryState.hasLoadAddUpdatePageData=t,console.log(typeof ApplicationGalleryState.hasLoadAddUpdatePageData),$(".bg_cover").slideDown(250),r.slideDown(250),ApplicationGalleryState.curUpdateID=d,r.find("fieldset .form-control").each(function(){var t="hastd_"+$(this).attr("id").split("_")[2],a=p.children("."+t).attr("title"),e=globalDataHandle(a,"");$(this).val(e)});var i=p.find(".hastd_CADdrawings").data("ivalue").toString().split("::");i=$.grep(i,function(t,a){return""!=t});var l="";i.map(function(t,a,e){l+='<li class="list-group-item list-group-item-info" title="'+t+'"><span class="badge">已上传</span>'+t+"</li>"}),$("#"+o+"_update_CADdrawings_list").empty().append(l);var n=p.find(".hastd_PDFdrawings").data("ivalue").toString().split("::");n=$.grep(n,function(t,a){return""!=t});var s="";n.map(function(t,a,e){s+='<li class="list-group-item list-group-item-info" title="'+t+'"><span class="badge">已上传</span>'+t+"</li>"}),$("#"+o+"_update_PDFdrawings_list").empty().append(s)}else $.MsgBox_Unload.Alert("提示","网络繁忙！读取修改模板失败！")})}),$(".search_in>div:eq(0) label").on("click",function(){"singleSelect"==$(this).children().val()?($(this).css("color","#333"),$(this).siblings("label").css("color","#fff"),$(".mixSelect_search").fadeOut(100)):($(this).css("color","#333"),$(this).siblings("label").css("color","#fff"),$(".mixSelect_search").fadeIn(100))}),$(document).on("click",".search_in ul.dropdown-menu>li",function(){var t=$(this).text(),a=$(this).attr("title");$(this).parent().siblings("button:nth-child(1)").attr("title",a).text(t);var e=$(this).parent().parent();"制定时间"==t||"设计时间"==t?e.siblings("input[type='text'], select").hide(10,function(){e.siblings("input[type='date']").fadeIn(50).val("")}):"使用情况"==t?e.siblings("input[type='text'], input[type='date']").hide(10,function(){e.siblings("select").fadeIn(50).val("")}):"选择字段"==t?e.siblings("input[type='text'], input[type='date'], select").hide(10):e.siblings("select, input[type='date']").hide(10,function(){e.siblings("input[type='text']").fadeIn(50).val("")})}),$(".classify_search_y").click(function(){var t,a,e,i,l=$(".search_in input[name='querytype']:checked").val();if(!l||"on"==l)return $.MsgBox_Unload.Alert("提示","请选择搜索类别"),!1;if("singleSelect"==l){if(!(t=$(".singleSelect_search div.input-group-btn>button:eq(0)").text())||"选择字段"==t)return $.MsgBox_Unload.Alert("提示","请选择搜索字段"),!1;if(!(a="使用情况"==t?$(".singleSelect_search>div select").val():"制定时间"==t||"设计时间"==t?$(".singleSelect_search>div input[type='date']").val():$(".singleSelect_search>div input[type='text']").val().trim()))return $.MsgBox_Unload.Alert("提示","搜索内容必填或必选"),!1}else if("mixSelect"==l){if(!(t=$(".singleSelect_search div.input-group-btn>button:eq(0)").text())||"选择字段"==t)return $.MsgBox_Unload.Alert("提示","请选择搜索字段"),!1;if(!(a="使用情况"==t?$(".singleSelect_search>div select").val():"制定时间"==t||"设计时间"==t?$(".singleSelect_search>div input[type='date']").val():$(".singleSelect_search>div input[type='text']").val().trim()))return $.MsgBox_Unload.Alert("提示","搜索内容必填或必选"),!1;if(!(e=$(".mixSelect_search div.input-group-btn>button:eq(0)").text())||"选择字段"==e)return $.MsgBox_Unload.Alert("提示","请选择搜索字段"),!1;if(!(i="使用情况"==e?$(".mixSelect_search>div select").val():"制定时间"==e||"设计时间"==e?$(".mixSelect_search>div input[type='date']").val():$(".mixSelect_search>div input[type='text']").val().trim()))return $.MsgBox_Unload.Alert("提示","搜索内容必填或必选"),!1}getDataByPage($(".tab_wrapper>ul>li.active").children("a").data("idiagram"),l,t,a,e,i,1)}),$(".classify_search_n").click(function(){getDataByPage("scheme",void 0,void 0,void 0,void 0,void 0,1),searchInit(),$("[id^='jumpNumber']").val("")}),$("[id^='jumpNumber']").on("input propertychange",function(){var t=$(this).val().replace(/[^\d]/g,"");$(this).val(t)}),$("[id^='fistPage']").click(function(){getDataByGoPage(1)}),$("[id^='lastPage']").click(function(){getDataByGoPage(Number($(this).parent().prev().find("[id^='allPage']").text()))}),$("[id^='upPage']").click(function(){var t=Number($(this).parent().prev().find("[id^='currentPage']").text());1!=t&&getDataByGoPage(--t)}),$("[id^='nextPage']").click(function(){var t=Number($(this).parent().prev().find("[id^='currentPage']").text());t!=Number($(this).parent().prev().find("[id^='allPage']").text())&&getDataByGoPage(++t)}),$("[id^='Gotojump']").click(function(){var t=$(this).siblings("input[id^='jumpNumber']").val().trim(),a=Number($(this).parent().prev().find("[id^='allPage']").text());t==Number($(this).parent().prev().find("[id^='currentPage']").text())||t<=0||a<t?$(this).siblings("input[id^='jumpNumber']").val(""):getDataByGoPage(t)}),$(document).on("click","span.td_download_file, li.list-group-item-success, li.list-group-item-info, ol>li",function(){var t=$(this).attr("title");if(!t||"--"==t)return $.MsgBox_Unload.Alert("下载提示","无数据或文件已被删除！"),!1;$.ajax({type:"GET",url:"FileDownload",data:{Folder:"ApplicationGallery",FileName:t}}).then(function(t){window.open(globalHostName+"/"+t)},function(){$.MsgBox_Unload.Alert("提示","服务器繁忙！")})});